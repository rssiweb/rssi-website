<!DOCTYPE html>
<html lang="en">

<head>
    <!--
RSSI
http://www.rssi.in
-->
    <title>Certificate portal</title>
</head>

<meta name="description" content="">
<meta name="author" content="">
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=Edge">
<meta name="viewport" content="width=device-width,
        initial-scale=1,maximum-scale=1">
<link rel="shortcut icon" href="/images/logo/favicon.ico" type="image/x-icon" />
<script src="/js/jquery.js"></script>
<script>
    $(function() {
        $("#header").load("/header.html");
        $("#footer").load("/footer.html");
    });
</script>
<link rel="stylesheet" href="/css/HeaderFooter.css">
<link rel="stylesheet" href="/css/bootstrap_sheet.min.css">

<!-- Main css -->
<link rel="stylesheet" href="/css/style.css">
<link rel="stylesheet" href="/css/addstyle.css">
<!-- Material Design Bootstrap -->
<!--<link href="/css/mdb.min_sheet.css" rel="stylesheet">-->

<style>
    body {
        line-height: unset;
    }
    
    .navbar {
        padding: unset;
        font-weight: unset;
        display: inline-block;
    }
    
    body,
    h1,
    h2,
    h3,
    h4,
    h5,
    h6 {
        font-weight: unset;
    }
    
    .text-center {
        text-align: left !important;
    }
    
    .table-striped tbody tr:nth-of-type(odd) {
        background-color: #fff;
    }
    
    .table-striped tbody tr {
        background-color: #FAFAFB
    }
    
    input,
    select {
        width: 150px;
    }
    
    input:focus,
    textarea:focus,
    select:focus {
        outline: none;
    }
    
    .exam_btn:hover {
        background: #90BAA4;
        border: 1px solid #90BAA4;
    }
</style>
<!-- =========================
     NAVIGATION LINKS     
============================== -->

<body>

    <div id="header"></div>

    <!-- NAVIGATION PATH -->

    <!--<img src="" alt="" width="100%"/><br>-->
    <div style="margin: 0.3%;">
        <ps class="marginleft notice" style="margin-left: 3%;">
            <a href="/index">Home</a> &#62; e-Certificate&#62; Associate</ps>
    </div>
    <br><br>
    <div class="container">
        <div clas="row">

            <!--<div class="col">
                <div style="text-align: right; width: 100%;" class="white
                        hoverdecoration">
                    <a href="https://drive.google.com/file/d/1tHMtne1_2a9dakskzhfFRxtS5qt5JNnL/view" target="_blank"
                        class="primary_btn" style="padding-right:3vh; padding-left:3vh;
                            margin-top: 1%; background-color: #90BAA4;
                            border-color: #90BAA4;">Gems criteria &nbsp;<i class="fas fa-award"
                            style="font-size: 20px"></i></a>
                </div>
            </div>-->
        </div>
    </div>
    <div class="container">
        <!--<span style="color: #F2545F; display: inline;"></span>-->
        <p style="display: inline;">You have to enter at least one value to get the certificate details.</p>
        <div class="row" style="background-color: rgb(255, 245,
                194);min-height: 70px;">


            <div class="col1">
                <label for="name">Associate No<span style="color: #F2545F"></span>&nbsp;</label>
                <input type="text" id="name" name="name" minlength="9" maxlength="9" size="12" style="text-transform:uppercase">
            </div>

            <div class="col2">
                <label for="ename">Certificate No<span style="color: #F2545F"></span>&nbsp;</label>
                <input type="text" name="ename" id="ename" minlength="9" maxlength="9" size="12" style="text-transform:uppercase">
                </select>
            </div>

            <div class="col3">
                <button type="button" class="exam_btn" onclick="loaddata()"><i class="fas fa-search"></i>
                    search</button>
            </div>


        </div>
    </div>


    <div class="container">
        <div class="row">
            <div class="col">

                <body>
                    <h2 style="margin-top:2%; font-size:20px;" align="center">Get Certificate Details</h2>
                    <div class="container text-center my-4" style="overflow-x:
                        auto;">
                        <!-- Table  -->
                        <table class="table bordered table-striped" id="testTable">
                            <!-- Table head -->
                            <thead style="background-color: whitesmoke;
                                font-style: oblique;">
                                <tr>
                                    <th width="8%"><b>Associate No</b></th>
                                    <th width="14%"><b>Name</b></th>
                                    <th width="8%"><b>Issued on</b></th>
                                    <th width="14%"><b>Badge Name</b></th>
                                    <th width="10%"><b>Certificate No</b></th>
                                    <th width="10%"><b>Certificate</b></th>
                                    <th><b>Comment</b></th>


                                </tr>
                            </thead>
                            <!-- Table head -->

                            <!-- Table body -->
                            <tbody id="demo">


                            </tbody>
                            <!-- Table body -->
                        </table>
                        <!-- Table  -->

                    </div>

            </div>
        </div>
    </div>
    <!-- =========================
     SCRIPTS   
============================== -->
    <script src="/js/pace.js"></script>
    <script src="/js/fontawsome.js"></script>
    <script src="/js/bootstrap.min.js"></script>
    <script src="/js/jquery.parallax.js"></script>
    <script src="/js/wow.min.js"></script>
    <script src="/js/custom.js"></script>
    <!-- Bootstrap tooltips -->
    <script type="text/javascript" src="/js/popper.min.js"></script>
    <!-- MDB core JavaScript -->
    <script type="text/javascript" src="/js/mdb.min.js"></script>
    <script type="text/javascript">
        var loaddata = function() {
            var associateno = document.getElementById('name').value.toUpperCase()
            var certificateno = document.getElementById('ename').value.toUpperCase()

            $.getJSON("https://spreadsheets.google.com/feeds/list/1I5WANuMzHDcb2m9-PoXIOV3aZIrABUGSfwPOPNh0HBY/5/public/values?alt=json",
                function(data) {
                    document.getElementById('demo').innerHTML = ""
                    var sheetData = data.feed.entry;
                    var i;
                    var records = []
                    for (i = 0; i < sheetData.length; i++) {
                        var AssociateNo = data.feed.entry[i]['gsx$associateno']['$t'];
                        var Name = data.feed.entry[i]['gsx$name']['$t'];
                        var Designation = data.feed.entry[i]['gsx$designation']['$t'];
                        var DOJ = data.feed.entry[i]['gsx$doj']['$t'];
                        var Yearsofservice = data.feed.entry[i]['gsx$yearsofservice']['$t'];
                        var Modeofservice = data.feed.entry[i]['gsx$modeofservice']['$t'];
                        var BadgeName = data.feed.entry[i]['gsx$badgename']['$t'];
                        var Receivedfor = data.feed.entry[i]['gsx$receivedfor']['$t'];
                        var Certificate = data.feed.entry[i]['gsx$certificate']['$t'];
                        var Issuedon = data.feed.entry[i]['gsx$issuedon']['$t'];
                        var CertificateNo = data.feed.entry[i]['gsx$certificateno']['$t'];

                        if ((AssociateNo === associateno && CertificateNo === certificateno) || (certificateno === "" && AssociateNo === associateno) || (associateno === "" && CertificateNo === certificateno)) {
                            // sort records
                            records.push({
                                Issuedon: Issuedon,
                                BadgeName: BadgeName,
                                CertificateNo: CertificateNo,
                                Certificate: Certificate,
                                Receivedfor: Receivedfor,
                                Name: Name,
                                AssociateNo: AssociateNo
                            })
                        }

                        // else {document.getElementById('demo').innerHTML= "no record2";}
                    }
                    if (records.length == 0) {
                        document.getElementById('demo').innerHTML += ('<tr>' + '<td></td><td>' + '<p style="color:#F2545F">No record found.</p>' + '</td></tr>');
                    } else {
                        records.forEach(item => {
                            {
                                document.getElementById('demo').innerHTML += ('<tr>' + '<td>' + item.AssociateNo + '</td>' + '<td>' + item.Name + '</td>' + '<td>' + item.Issuedon + '</td>' + '<td>' + item.BadgeName + '</td>' + '<td>' + item.CertificateNo + '</td>' + '<td>' + '<span class="noticet"><a href="' + item.Certificate + '"target="_blank">Download</a></span>' + '</td>' + '<td>' + item.Receivedfor + '</td>' + '</tr>');
                            }
                        })
                    }
                });
        }

        document.addEventListener("DOMContentLoaded", function() {
            var lazyloadImages = document.querySelectorAll("img.lazy");
            var lazyloadThrottleTimeout;

            function lazyload() {
                if (lazyloadThrottleTimeout) {
                    clearTimeout(lazyloadThrottleTimeout);
                }

                lazyloadThrottleTimeout = setTimeout(function() {
                    var scrollTop = window.pageYOffset;
                    lazyloadImages.forEach(function(img) {
                        if (img.offsetTop < (window.innerHeight + scrollTop)) {
                            img.src = img.dataset.src;
                            img.classList.remove('lazy');
                        }
                    });
                    if (lazyloadImages.length == 0) {
                        document.removeEventListener("scroll", lazyload);
                        window.removeEventListener("resize", lazyload);
                        window.removeEventListener("orientationChange", lazyload);
                    }
                }, 20);
            }

            document.addEventListener("scroll", lazyload);
            window.addEventListener("resize", lazyload);
            window.addEventListener("orientationChange", lazyload);
        });
    </script>
    <!-- =========================
     FOOTER   
============================== -->
    <!-- Back top -->
    <a href="#back-top" class="go-top"><i class="fa fa-angle-up"></i></a>
    <div id="footer"></div>
    </body>

</html>