<!DOCTYPE html>
<html lang="en">

<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=AW-11316670180"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'AW-11316670180');
    </script>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">

    <title>RSSI NGO Announcements | Official Updates & Notices</title>

    <meta name="description"
        content="Stay updated with official announcements, notices, and important updates from RSSI NGO. Get the latest information on programs, events, initiatives, and organizational updates directly from RSSI NGO.">

    <meta name="keywords"
        content="RSSI NGO announcements, RSSI NGO updates, RSSI notices, NGO announcements India, RSSI NGO news, social initiatives updates, education NGO announcements, Kalpana Buds School updates">

    <meta name="author" content="RSSI NGO">
    <meta property="og:image" content="https://rssi.in/img/og_image.png">

    <!-- Favicons -->
    <link href="/img/favicon.ico" rel="icon">
    <link href="/img/apple-touch-icon.png" rel="apple-touch-icon">

    <!-- Vendor CSS Files -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">

    <!-- Template Main CSS File -->
    <link href="/css/main.css?v=1.3.5" rel="stylesheet">

    <style>
        /* Base Styles for #custom-section */
        #custom-section {
            background-color: #ffffff;
            /* Pure white background */
            /* padding: 3rem 0; */
        }

        #custom-section .container {
            background-color: #ffffff;
            /* Pure white container */
            /* padding: 2rem; */
            border-radius: 0.5rem;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
            /* Subtle shadow */
        }

        /* Section Titles */
        #custom-section .section-title {
            font-size: 1.75rem;
            font-weight: 600;
            margin-bottom: 1.5rem;
            color: #2c3e50;
            /* Dark gray for contrast */
            position: relative;
            display: inline-block;
        }

        #custom-section .section-title::after {
            content: '';
            position: absolute;
            left: 0;
            bottom: -5px;
            width: 100%;
            height: 3px;
            background: #e9ecef;
            /* Light gray underline */
            border-radius: 2px;
        }

        /* Cards */
        #custom-section .card {
            background-color: #ffffff;
            /* Pure white card */
            border: 1px solid #e9ecef;
            /* Light border */
            border-radius: 0.5rem;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
            /* Subtle shadow */
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            transition: all 0.3s ease;
        }

        #custom-section .card:hover {
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            /* Slightly stronger shadow on hover */
        }

        /* List Group Items (News Highlights) */
        #custom-section .list-group-item {
            border: none;
            padding: 1rem 0;
            color: #555;
            /* Dark gray for text */
            display: flex;
            flex-direction: column;
            align-items: flex-start;
        }

        #custom-section .list-group-item:last-child {
            border-bottom: none;
        }

        #custom-section .list-group-item .notice-content {
            display: flex;
            align-items: center;
        }

        #custom-section .list-group-item .badge {
            margin-left: 0.5rem;
        }

        #custom-section .list-group-item .date {
            display: block;
            margin-top: 0.25rem;
            font-size: 0.875rem;
            color: #777;
            /* Light gray for date */
        }

        /* Scrollable Content (Activities & Initiatives) */
        #custom-section .scrollable-content {
            overflow-y: auto;
            flex-grow: 1;
            max-height: 590px;
            padding: 1rem;
            margin-bottom: 1.5rem;
            /* White space below */
        }

        #custom-section .scrollable-content::-webkit-scrollbar {
            width: 8px;
            /* Scrollbar width */
        }

        #custom-section .scrollable-content::-webkit-scrollbar-track {
            background: #f8f9fa;
            /* Track color */
            border-radius: 4px;
        }

        #custom-section .scrollable-content::-webkit-scrollbar-thumb {
            background: #e9ecef;
            /* Thumb color */
            border-radius: 4px;
        }

        /* Blog Posts Container */
        #custom-section #blog-posts {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
            /* Spacing between posts */
        }

        /* Post Card */
        #custom-section .post {
            background-color: #ffffff;
            /* Pure white background */
            border: 1px solid #e9ecef;
            /* Light border */
            border-radius: 0.5rem;
            padding: 1.5rem;
            transition: all 0.3s ease;
        }

        #custom-section .post:hover {
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            /* Subtle shadow on hover */
        }

        /* Profile Photo */
        #custom-section .profile-photo img,
        #custom-section .profile-photo div {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            object-fit: cover;
        }

        #custom-section .profile-photo div {
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: #e9ecef;
            /* Light gray background */
            color: #555;
            /* Dark gray text */
            font-size: 1.25rem;
            font-weight: 600;
        }

        /* Post Content */
        #custom-section .post h5 {
            font-size: 1.25rem;
            font-weight: 600;
            color: #2c3e50;
            /* Dark gray for heading */
            margin-bottom: 0.25rem;
        }

        #custom-section .post small {
            font-size: 0.875rem;
            color: #777;
            /* Light gray for date */
        }

        #custom-section .post p {
            font-size: 1rem;
            color: #555;
            /* Dark gray for text */
            margin: 1rem 0;
            line-height: 1.5;
        }

        /* Like Section */
        #custom-section .post .pointer {
            cursor: pointer;
            display: flex;
            align-items: center;
            color: #555;
            /* Dark gray for text */
            transition: color 0.3s ease;
        }

        #custom-section .post .pointer:hover {
            color: #2c3e50;
            /* Darker gray on hover */
        }

        #custom-section .post .pointer i {
            margin-right: 0.5rem;
        }

        /* Load More Button */
        #custom-section #load-more-btn {
            background-color: #f8f9fa;
            /* Off-white background */
            border: 1px solid #e9ecef;
            /* Light border */
            color: #555;
            /* Dark gray text */
            padding: 0.5rem 1.5rem;
            border-radius: 0.25rem;
            transition: all 0.3s ease;
        }

        #custom-section #load-more-btn:hover {
            background-color: #e9ecef;
            /* Light gray on hover */
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            /* Shadow on hover */
        }

        /* No More Posts Message */
        #custom-section #no-more-posts {
            color: #777;
            /* Light gray text */
            font-style: italic;
        }

        /* Loading Spinner */
        #custom-section #loading-spinner {
            display: none;
            padding: 1rem 0;
            text-align: center;
        }

        #custom-section #loading-spinner .spinner-border {
            width: 2rem;
            height: 2rem;
            border-width: 0.2em;
            color: #e9ecef;
            /* Light gray spinner */
        }

        #custom-section #loading-spinner span {
            margin-left: 0.5rem;
            color: #555;
            /* Dark gray text */
        }
    </style>
    <style>
        /* Initial state: Low opacity */
        .btn-read-more {
            opacity: 0.5;
            transition: opacity 0.3s ease;
            /* Smooth transition */
        }

        /* Hover state: Increase opacity */
        .btn-read-more:hover {
            opacity: 0.8;
        }

        /* Focus state: Increase opacity (only for keyboard focus) */
        .btn-read-more:focus-visible {
            opacity: 1;
        }

        /* Active state (when clicked): Increase opacity */
        .btn-read-more:active {
            opacity: 1;
        }
    </style>
</head>

<body>

    <!-- ======= Header ======= -->
    <div id="header"></div>
    <!-- End Header -->

    <main id="main">

        <!-- ======= Breadcrumbs ======= -->
        <!-- Replace your existing breadcrumbs div with this -->
        <div class="breadcrumbs">
            <div class="container">
                <div class="d-flex justify-content-between align-items-center">
                    <h2 id="page-title"></h2>
                    <ol id="breadcrumb-list"></ol>
                </div>
            </div>
        </div>

        <!-- End Breadcrumbs -->

        <section class="sample-page">
            <div class="container" data-aos="fade-up">
                <div id="custom-section" class="container">
                    <div class="row">
                        <div class="col-md-6">
                            <!-- <section class="section-content"> -->
                            <h3 class="section-title">Announcements</h3>
                            <div class="news-item card">
                                <!-- Nav tabs -->
                                <ul class="nav nav-tabs" id="announcementTabs" role="tablist">
                                    <li class="nav-item" role="presentation">
                                        <button class="nav-link active" id="news-tab" data-bs-toggle="tab"
                                            data-bs-target="#news-tab-pane" type="button" role="tab"
                                            aria-controls="news-tab-pane" aria-selected="true">News Highlights</button>
                                    </li>
                                    <li class="nav-item" role="presentation">
                                        <button class="nav-link" id="notices-tab" data-bs-toggle="tab"
                                            data-bs-target="#notices-tab-pane" type="button" role="tab"
                                            aria-controls="notices-tab-pane" aria-selected="false">Notices</button>
                                    </li>
                                </ul>

                                <!-- Tab panes -->
                                <div class="tab-content">
                                    <div class="tab-pane fade show active" id="news-tab-pane" role="tabpanel"
                                        aria-labelledby="news-tab" tabindex="0">
                                        <ul class="list-group list-group-flush" id="news-list">
                                            <!-- News items will be dynamically inserted here -->
                                        </ul>
                                        <!-- Load More News button (will be shown only for News tab) -->
                                    </div>
                                    <div class="tab-pane fade" id="notices-tab-pane" role="tabpanel"
                                        aria-labelledby="notices-tab" tabindex="0">
                                        <ul class="list-group list-group-flush" id="notices-list">
                                            <!-- Notice items will be dynamically inserted here -->
                                        </ul>
                                        <!-- Load More Notices button (will be shown only for Notices tab) -->
                                    </div>
                                </div>
                            </div>
                            <!-- </section> -->
                        </div>

                        <!-- Activities & Initiatives Section -->
                        <div class="col-md-6">
                            <!-- <section class="section-content"> -->
                            <h2 class="section-title">Activities & Initiatives</h2>
                            <div class="scrollable-content card">
                                <!-- Blog Posts Container -->
                                <div id="blog-posts"></div>

                                <!-- Loading Spinner and Text -->
                                <div class="d-flex justify-content-center align-items-center" id="loading-spinner">
                                    <div class="spinner-border text-primary" role="status">
                                        <span class="visually-hidden">Loading...</span>
                                    </div>
                                    <span class="ms-2">Loading...</span>
                                </div>

                                <!-- Load More Button and No More Posts Message -->
                                <div class="d-flex justify-content-center mt-4">
                                    <button id="load-more-btn" class="btn btn-gradient">Load More</button>
                                    <p id="no-more-posts" class="text-muted text-center mt-4" style="display: none;">
                                        That's all we have for you now.
                                    </p>
                                </div>
                            </div>
                            <!-- </section> -->
                        </div>
                    </div>
                </div>
        </section>
        <!-- End Gallery Section -->
    </main>
    <!-- End #main -->
    <!-- ======= Footer ======= -->
    <div id="footer"></div>
    <!-- End Footer -->

    <a href="#" class="scroll-top d-flex align-items-center justify-content-center"><i
            class="bi bi-arrow-up-short"></i></a>

    <!--<div id="preloader"></div>-->

    <!-- Vendor JS Files -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4"
        crossorigin="anonymous"></script>

    <!-- Template Main JS File -->
    <!-- Load jQuery -->
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script src="/js/main.js?v=1.6.1"></script>

    <script src="https://cdn.jsdelivr.net/gh/manucaralmo/GlowCookies@3.0.1/src/glowCookies.min.js"></script>
    <!-- Glow Cookies v3.0.1 -->
    <script>
        glowCookies.start('en', {
            analytics: 'G-S25QWTFJ2S',
            //facebookPixel: '',
            policyLink: 'disclaimer'
        });
    </script>

    <script>
        const baseURL = window.location.hostname === "localhost"
            ? "http://localhost:8082"
            : "https://login.rssi.in";

        let offset = 0;
        const limit = 3;

        // Fetch blog data from the PHP backend
        async function fetchBlogData() {
            try {
                console.log("Fetching blog data..."); // Debugging

                // Show spinner and "Loading..." text
                document.getElementById('loading-spinner').style.display = 'flex';
                console.log("Spinner shown"); // Debugging

                // Hide the "Load More" button while loading
                document.getElementById('load-more-btn').style.display = 'none';
                console.log("Load More button hidden during loading"); // Debugging

                const response = await fetch(`${baseURL}/get_blog_data.php?offset=${offset}&limit=${limit}`);
                const data = await response.json();

                console.log("Data fetched:", data); // Debugging

                if (data.success) {
                    console.log("Data fetched successfully"); // Debugging
                    renderBlogPosts(data.events, data.likes);

                    // Hide spinner and "Loading..." text
                    document.getElementById('loading-spinner').style.display = 'none';
                    console.log("Spinner hidden"); // Debugging

                    // Show "Load More" button if there are more posts
                    if (data.has_more) {
                        document.getElementById('load-more-btn').style.display = 'block';
                        console.log("Load More button shown"); // Debugging
                    } else {
                        // Hide "Load More" button and show "No more posts" message
                        document.getElementById('load-more-btn').style.display = 'none';
                        document.getElementById('no-more-posts').style.display = 'block';
                        console.log("No more posts message shown"); // Debugging
                    }
                } else {
                    console.error('Failed to fetch blog data');
                }
            } catch (error) {
                console.error('Error fetching blog data:', error);
            } finally {
                // Ensure the spinner is hidden even if an error occurs
                document.getElementById('loading-spinner').style.display = 'none';
                console.log("Spinner hidden (finally)"); // Debugging
            }
        }

        // Function to convert URLs to clickable links
        function makeClickableLinks(text) {
            const urlPattern = /(https?:\/\/[^\s]+)/g;
            return text.replace(urlPattern, '<a href="$1">$1</a>');
        }

        // Function to convert newlines to <br> tags
        function nl2br(text) {
            return text.replace(/\n/g, '<br>');
        }

        // Render blog posts on the page
        function renderBlogPosts(events, likes) {
            const blogPostsContainer = document.getElementById('blog-posts');

            events.forEach(event => {
                const eventHtml = `
                <div class="post">
                    <div class="d-flex align-items-center mb-3">
                        <div class="profile-photo">
                            ${event.photo ? `<img src="${event.photo}" alt="${event.fullname}">` :
                        `<div class="d-flex align-items-center justify-content-center bg-secondary text-white" style="width: 50px; height: 50px; border-radius: 50%;">
                                ${event.fullname.charAt(0).toUpperCase()}
                            </div>`}
                        </div>
                        <div>
                            <h5 class="mb-0">${event.fullname}</h5>
                            <small class="text-muted">${new Date(event.created_at).toLocaleString()}</small>
                        </div>
                    </div>
                    <!--<h3>${event.event_name}</h3>-->
                    <p>${nl2br(makeClickableLinks(event.event_description))}</p>
                    ${event.event_image_url ? `<img src="${event.event_image_url}" class="img-fluid rounded mb-3" alt="Event image" style="max-height: 500px; object-fit: contain;" loading="lazy">` : ''}
                    <div class="d-flex align-items-center mt-3 text-muted">
                        <div class="pointer" onclick="toggleLike(${event.event_id})">
                            <i class="bi bi-hand-thumbs-up me-1"></i>
                            <span>Like</span>
                            <span class="ms-2">${likes[event.event_id].like_count}</span>
                        </div>
                        <div class="ms-2">
                            ${likes[event.event_id].liked_users.slice(0, 2).join(', ')} 
                            ${likes[event.event_id].liked_users.length > 2 ? `and ${likes[event.event_id].liked_users.length - 2} others` : ''}
                        </div>
                    </div>
                </div>
            `;
                blogPostsContainer.insertAdjacentHTML('beforeend', eventHtml);
            });
        }

        // Load more posts when the button is clicked
        document.getElementById('load-more-btn').addEventListener('click', () => {
            offset += limit;
            fetchBlogData();
        });

        // Fetch and render blog data when the page loads
        document.addEventListener('DOMContentLoaded', fetchBlogData);
    </script>
    <!-- View More Modal (Simplified - no tabs) -->
    <div class="modal fade" id="viewMoreModal" tabindex="-1" aria-labelledby="viewMoreModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="viewMoreModalLabel">All Announcements</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <!-- Spinner for loading -->
                    <div id="loadingSpinner" class="text-center">
                        <div class="spinner-border text-primary" role="status">
                            <span class="visually-hidden">Loading...</span>
                        </div>
                        <p>Loading...</p>
                    </div>

                    <!-- Container for items -->
                    <div id="dataContainer" class="d-none">
                        <ul id="dataListModal" class="list-group"></ul>
                        <!-- Pagination -->
                        <nav aria-label="Data Pagination">
                            <ul id="dataPagination" class="pagination justify-content-center mt-3"></ul>
                        </nav>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script>
        // Function to check if a date is within the last 7 days
        function isRecent(date) {
            const currentDate = new Date();
            const itemDate = new Date(date);
            const timeDifference = currentDate - itemDate;
            const daysDifference = timeDifference / (1000 * 3600 * 24);
            return daysDifference <= 7;
        }

        // Function to format the date
        function formatDate(date) {
            return new Date(date).toLocaleDateString('en-GB', {
                day: 'numeric',
                month: 'short',
                year: 'numeric'
            });
        }

        // Function to create list items
        function createListItem(item, isNews = true) {
            const listItem = document.createElement('li');
            listItem.className = 'list-group-item';
            const dateText = `Released: ${formatDate(item.date)}`;
            const newBadge = isRecent(item.date) ? `<span class="badge bg-danger blinking-badge">New</span>` : '';
            listItem.innerHTML = `
            <div class="notice-content">
                <a href="${item.url}" class="text-decoration-none text-dark">
                    ${item.subject}
                </a>
                ${newBadge}
            </div>
            <small class="date text-muted">${dateText}</small>
        `;
            return listItem;
        }

        // Global variables
        let currentPage = 1;
        const itemsPerPage = 5;
        let currentDataType = 'news';
        let allData = [];

        // Fetch data from the PHP endpoint
        async function fetchData() {
            try {
                const response = await fetch(`${baseURL}/fetch_data_news.php`);
                const data = await response.json();

                if (data.success) {
                    // Render news
                    const newsList = document.getElementById('news-list');
                    data.news.forEach(news => {
                        newsList.appendChild(createListItem(news, true));
                    });

                    // Render notices
                    const noticesList = document.getElementById('notices-list');
                    data.notices.forEach(notice => {
                        noticesList.appendChild(createListItem(notice, false));
                    });

                    // Add load more buttons to respective containers
                    const newsLoadMoreContainer = document.createElement('div');
                    newsLoadMoreContainer.className = 'text-end p-3';
                    newsLoadMoreContainer.innerHTML = `
                    <button class="btn btn-read-more" data-bs-toggle="modal" data-bs-target="#viewMoreModal" onclick="loadAllData('news')">
                        Load More News
                    </button>
                `;
                    document.getElementById('news-tab-pane').appendChild(newsLoadMoreContainer);

                    const noticesLoadMoreContainer = document.createElement('div');
                    noticesLoadMoreContainer.className = 'text-end p-3';
                    noticesLoadMoreContainer.innerHTML = `
                    <button class="btn btn-read-more" data-bs-toggle="modal" data-bs-target="#viewMoreModal" onclick="loadAllData('notices')">
                        Load More Notices
                    </button>
                `;
                    document.getElementById('notices-tab-pane').appendChild(noticesLoadMoreContainer);

                    // Initially hide the notices load more container
                    noticesLoadMoreContainer.style.display = 'none';

                    // Set up tab change event listeners
                    const newsTab = document.getElementById('news-tab');
                    const noticesTab = document.getElementById('notices-tab');

                    newsTab.addEventListener('shown.bs.tab', function () {
                        newsLoadMoreContainer.style.display = 'block';
                        noticesLoadMoreContainer.style.display = 'none';
                    });

                    noticesTab.addEventListener('shown.bs.tab', function () {
                        newsLoadMoreContainer.style.display = 'none';
                        noticesLoadMoreContainer.style.display = 'block';
                    });
                } else {
                    console.error('Failed to fetch data');
                }
            } catch (error) {
                console.error('Error fetching data:', error);
            }
        }

        // Function to load all data (news or notices)
        async function loadAllData(dataType) {
            currentDataType = dataType;
            currentPage = 1;

            try {
                // Show spinner and hide container
                document.getElementById('loadingSpinner').classList.remove('d-none');
                document.getElementById('dataContainer').classList.add('d-none');

                // Set modal title based on data type
                document.getElementById('viewMoreModalLabel').textContent =
                    dataType === 'news' ? 'All News Highlights' : 'All Notices';

                // Fetch all items of the requested type
                const response = await fetch(`${baseURL}/fetch_data_news.php?fetch_all_${dataType}=true`);
                const data = await response.json();

                if (data.success) {
                    allData = data[dataType];
                    renderData();
                    renderPagination();
                } else {
                    console.error('Failed to fetch data');
                }
            } catch (error) {
                console.error('Error fetching data:', error);
            } finally {
                // Hide spinner and show container
                document.getElementById('loadingSpinner').classList.add('d-none');
                document.getElementById('dataContainer').classList.remove('d-none');
            }
        }

        // Function to render data
        function renderData() {
            const listModal = document.getElementById('dataListModal');
            listModal.innerHTML = ''; // Clear previous items

            const start = (currentPage - 1) * itemsPerPage;
            const end = start + itemsPerPage;
            const paginatedItems = allData.slice(start, end);

            paginatedItems.forEach(item => {
                listModal.appendChild(createListItem(item, currentDataType === 'news'));
            });
        }

        // Function to render pagination
        function renderPagination() {
            const pagination = document.getElementById('dataPagination');
            pagination.innerHTML = ''; // Clear previous pagination

            const totalPages = Math.ceil(allData.length / itemsPerPage);

            // Previous button
            const prevItem = document.createElement('li');
            prevItem.className = `page-item ${currentPage === 1 ? 'disabled' : ''}`;
            prevItem.innerHTML = `<a class="page-link" href="#" onclick="changePage(${currentPage - 1})">Previous</a>`;
            pagination.appendChild(prevItem);

            // Page numbers
            for (let i = 1; i <= totalPages; i++) {
                const pageItem = document.createElement('li');
                pageItem.className = `page-item ${i === currentPage ? 'active' : ''}`;
                pageItem.innerHTML = `<a class="page-link" href="#" onclick="changePage(${i})">${i}</a>`;
                pagination.appendChild(pageItem);
            }

            // Next button
            const nextItem = document.createElement('li');
            nextItem.className = `page-item ${currentPage === totalPages ? 'disabled' : ''}`;
            nextItem.innerHTML = `<a class="page-link" href="#" onclick="changePage(${currentPage + 1})">Next</a>`;
            pagination.appendChild(nextItem);
        }

        // Function to change page
        function changePage(page) {
            currentPage = page;
            renderData();
            renderPagination();
        }

        // Fetch and render data when the page loads
        document.addEventListener('DOMContentLoaded', fetchData);
    </script>

</body>

</html>