<!DOCTYPE html>
<html lang="en">

<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=AW-11316670180"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'AW-11316670180');
    </script>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">

    <title>RSSI-Announcements</title>
    <meta content="" name="description">
    <meta content="" name="keywords">

    <!-- Favicons -->
    <link href="/img/favicon.ico" rel="icon">
    <link href="/img/apple-touch-icon.png" rel="apple-touch-icon">

    <!-- Vendor CSS Files -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">

    <!-- Template Main CSS File -->
    <link href="/css/main.css" rel="stylesheet">
    
    <style>
        #custom-section {
            /* background-color: #eee; */
            color: #333;
            padding: 2rem;
        }

        #custom-section .container {
            background-color: #fff;
            padding: 2rem;
            border-radius: 0.25rem;
            box-shadow: 0 0.125rem 0.25rem rgba(0, 0, 0, 0.075);
        }

        /* #custom-section .section-title {
                font-size: 1.5rem;
                font-weight: bold;
                margin-bottom: 1.5rem;
                color: #fff;
                background-color: #c0392b;
                padding: 0.5rem;
                border-radius: 0.25rem;
            } */

        #custom-section .section-title {
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 1.5rem;
            color: #c0392b;
            /* Use the red color for text */
            padding-bottom: 0.5rem;
            /* Space for the underline */
            position: relative;
            /* Required for the pseudo-element */
            display: inline-block;
            /* Ensure the underline only spans the text */
        }

        #custom-section .section-title::after {
            content: '';
            position: absolute;
            left: 0;
            bottom: 0;
            width: 100%;
            height: 3px;
            /* Thickness of the underline */
            background: linear-gradient(90deg, #c0392b, #e74c3c);
            /* Gradient underline */
            border-radius: 2px;
            /* Slightly rounded corners */
        }

        #custom-section .news-item,
        #custom-section .info-item,
        #custom-section .activity-item {
            margin-bottom: 1.5rem;
            background-color: #fff;
            /* padding: 1rem; */
            border-radius: 0.25rem;
            box-shadow: 0 0.125rem 0.25rem rgba(0, 0, 0, 0.075);
        }

        #custom-section .news-item h3,
        #custom-section .info-item h3,
        #custom-section .activity-item h3 {
            font-size: 1.25rem;
            font-weight: bold;
            margin-bottom: 1rem;
            color: #c0392b;
        }

        #custom-section .list-group-item {
            /* border-bottom: 1px solid #dee2e6; */
            /* Add a line separator */
            /* padding: 0.75rem 0; */
            /* Adjust padding for better spacing */
            color: #555;
            display: flex;
            flex-direction: column;
            /* Stack content vertically */
            align-items: flex-start;
            /* Align items to the start */
        }

        #custom-section .list-group-item:last-child {
            border-bottom: none;
            /* Remove the line separator for the last item */
        }

        #custom-section .list-group-item .notice-content {
            display: flex;
            align-items: center;
            /* Align notice text and badge horizontally */
        }

        #custom-section .list-group-item .badge {
            margin-left: 0.5rem;
            /* Space between notice text and badge */
        }

        #custom-section .list-group-item .date {
            display: block;
            /* Ensure date is on a new line */
            margin-top: 0.25rem;
            /* Add some space between notice text and date */
        }

        #custom-section .text-primary {
            color: #c0392b !important;
        }

        .section-content {
            display: flex;
            flex-direction: column;
            height: 100%;
        }

        .scrollable-content {
            overflow-y: auto;
            flex-grow: 1;
            max-height: 500px;
            /* Adjust as needed */
            padding-top: 1rem;
        }

        .fixed-header {
            position: sticky;
            top: 0;
            background: #c0392b;
            z-index: 10;
            padding: 10px 0;
            margin-bottom: 1rem;
        }

        /* Ensure links look like regular text but are clickable */
        .list-group-item a {
            color: inherit;
            text-decoration: none;
        }

        .list-group-item a:hover {
            text-decoration: underline !important;
        }

        section {
            padding: 0;
        }
    </style>
</head>

<body>

    <!-- ======= Header ======= -->
    <div id="header"></div>
    <!-- End Header -->

    <main id="main">

        <!-- ======= Breadcrumbs ======= -->
        <div class="breadcrumbs">
            <div class="container">

                <div class="d-flex justify-content-between align-items-center">
                    <h2>Announcement</h2>
                    <ol>
                        <li><a href="index">Home</a></li>
                        <li>Announcement</li>
                    </ol>
                </div>

            </div>
        </div>

        <!-- End Breadcrumbs -->

        <!-- <section class="sample-page"> -->
        <div id="custom-section">
            <div class="container">
                <div class="row">
                    <!-- Notice Section -->
                    <div class="col-md-12">
                        <section class="section-content">
                            <h2 class="section-title">Announcements</h2>
                            <div class="info-item">
                                <!-- Notice List -->
                                <ul class="list-group list-group-flush" id="notice-list">
                                    <!-- Notice items will be dynamically inserted here -->
                                </ul>
                                <!-- Loading Spinner and Text -->
                                <div class="d-flex justify-content-center align-items-center" id="loading-spinner">
                                    <div class="spinner-border" role="status">
                                        <span class="visually-hidden">Loading...</span>
                                    </div>
                                    <span class="ms-2">Loading...</span>
                                </div>
                            </div>
                        </section>
                    </div>
                </div>
            </div>
        </div>
        <!-- </section> -->
        <!-- End Gallery Section -->
    </main>
    <!-- End #main -->
    <!-- ======= Footer ======= -->
    <div id="footer"></div>
    <!-- End Footer -->

    <a href="#" class="scroll-top d-flex align-items-center justify-content-center"><i
            class="bi bi-arrow-up-short"></i></a>

    <!--<div id="preloader"></div>-->

    <!-- Vendor JS Files -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4"
        crossorigin="anonymous"></script>

    <!-- Template Main JS File -->
    <script src="/js/main.js"></script>

    <script src="https://cdn.jsdelivr.net/gh/manucaralmo/GlowCookies@3.0.1/src/glowCookies.min.js"></script>
    <!-- Glow Cookies v3.0.1 -->
    <script>
        glowCookies.start('en', {
            analytics: 'G-S25QWTFJ2S',
            //facebookPixel: '',
            policyLink: 'disclaimer'
        });
    </script>
    <script>
        const baseURL = window.location.hostname === "localhost"
            ? "http://localhost:8082"
            : "https://login.rssi.in";

        // Function to check if a date is within the last 7 days
        function isRecent(date) {
            const currentDate = new Date();
            const itemDate = new Date(date);
            const timeDifference = currentDate - itemDate;
            const daysDifference = timeDifference / (1000 * 3600 * 24);
            return daysDifference <= 7;
        }

        // Function to format the date
        function formatDate(date) {
            return new Date(date).toLocaleDateString('en-GB', {
                day: 'numeric',
                month: 'short',
                year: 'numeric'
            });
        }

        // Fetch data from the PHP endpoint
        async function fetchData() {
            try {
                // Show spinner and "Loading..." text
                const loadingSpinner = document.getElementById('loading-spinner');
                loadingSpinner.style.display = 'flex';
                console.log("Spinner shown"); // Debugging

                // Fetch data from the PHP endpoint
                const response = await fetch(`${baseURL}/fetch_data_news.php`);
                const data = await response.json();

                if (data.success) {
                    // Render notices
                    const noticeList = document.getElementById('notice-list');
                    if (!noticeList) {
                        console.error("Notice list container not found!");
                        return;
                    }

                    // Clear any existing items in the list
                    noticeList.innerHTML = '';

                    // Loop through the notices and create list items
                    data.notices.forEach(notice => {
                        const listItem = document.createElement('li');
                        listItem.className = 'list-group-item';
                        const dateText = `Issued: ${formatDate(notice.date)}`;
                        const newBadge = isRecent(notice.date) ? `<span class="badge bg-danger blinking-badge">New</span>` : '';
                        listItem.innerHTML = `
                        <div class="notice-content">
                            <a href="${notice.url}" target="_blank" class="text-decoration-none text-dark">
                                ${notice.subject}
                            </a>
                            ${newBadge}
                        </div>
                        <small class="date text-muted">${dateText}</small>
                    `;
                        noticeList.appendChild(listItem);
                    });

                    // Hide spinner and "Loading..." text
                    loadingSpinner.style.display = 'none';
                    console.log("Spinner hidden"); // Debugging
                } else {
                    console.error('Failed to fetch data');
                }
            } catch (error) {
                console.error('Error fetching data:', error);
            } finally {
                // Ensure the spinner is hidden even if an error occurs
                const loadingSpinner = document.getElementById('loading-spinner');
                loadingSpinner.style.display = 'none';
                console.log("Spinner hidden (finally)"); // Debugging
            }
        }

        // Fetch and render data when the page loads
        document.addEventListener('DOMContentLoaded', fetchData);
    </script>

</body>

</html>